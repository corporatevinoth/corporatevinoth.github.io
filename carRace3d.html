<!DOCTYPE html>
<html>
<head>
  <title>3D Car Race</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; background: #87CEEB; }
  </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let width = window.innerWidth;
let height = window.innerHeight;
canvas.width = width;
canvas.height = height;

// Sky with clouds
function drawSky() {
  ctx.fillStyle = "#87CEEB"; // Blue sky
  ctx.fillRect(0, 0, width, height);

  // Draw clouds
  for (let i = 0; i < 5; i++) {
    let x = (i * 300 + 100) % width;
    let y = 60 + (i % 2) * 40;
    ctx.beginPath();
    ctx.arc(x, y, 40, 0, Math.PI * 2);
    ctx.arc(x + 40, y, 30, 0, Math.PI * 2);
    ctx.arc(x - 40, y, 30, 0, Math.PI * 2);
    ctx.fillStyle = "#FFF";
    ctx.globalAlpha = 0.8;
    ctx.fill();
    ctx.globalAlpha = 1;
  }
}

// Road
function drawRoad() {
  ctx.save();
  ctx.beginPath();
  ctx.moveTo(width * 0.35, height);
  ctx.lineTo(width * 0.45, 0);
  ctx.lineTo(width * 0.55, 0);
  ctx.lineTo(width * 0.65, height);
  ctx.closePath();
  ctx.fillStyle = "#333";
  ctx.fill();

  // Road lane markings
  ctx.strokeStyle = "#fff";
  ctx.lineWidth = 4;
  for (let i = 0; i < 20; i++) {
    let y = height - i * 80;
    let x1 = width * 0.5 - 10;
    let x2 = width * 0.5 + 10;
    ctx.beginPath();
    ctx.moveTo(x1, y);
    ctx.lineTo(x2, y - 40);
    ctx.stroke();
  }
  ctx.restore();
}

// Buildings
function drawBuildings() {
  for (let i = 0; i < 8; i++) {
    // Left side
    ctx.fillStyle = i % 2 === 0 ? "#b0b0b0" : "#e0e0e0";
    ctx.fillRect(width * 0.15, height - i * 150 - 250, 60, 120);

    // Windows
    ctx.fillStyle = "#a0d4e0";
    for (let w = 0; w < 5; w++) {
      for (let h = 0; h < 2; h++) {
        ctx.fillRect(width * 0.15 + 10 + w * 8, height - i * 150 - 230 + h * 45, 6, 16);
      }
    }

    // Right side
    ctx.fillStyle = i % 2 === 0 ? "#b0b0b0" : "#e0e0e0";
    ctx.fillRect(width * 0.85 - 60, height - i * 150 - 250, 60, 120);

    // Windows
    ctx.fillStyle = "#a0d4e0";
    for (let w = 0; w < 5; w++) {
      for (let h = 0; h < 2; h++) {
        ctx.fillRect(width * 0.85 - 50 + w * 8, height - i * 150 - 230 + h * 45, 6, 16);
      }
    }
  }
}

// Trees
function drawTrees() {
  for (let i = 0; i < 16; i++) {
    // Left side
    let x = width * 0.25 - 30;
    let y = height - i * 90 - 120;
    ctx.fillStyle = "#8B5A2B"; // Brown trunk
    ctx.fillRect(x, y, 8, 30);
    ctx.beginPath();
    ctx.arc(x + 4, y, 24, 0, Math.PI * 2);
    ctx.fillStyle = "#228B22"; // Green leaves
    ctx.fill();

    // Right side
    x = width * 0.75 + 22;
    ctx.fillStyle = "#8B5A2B";
    ctx.fillRect(x, y, 8, 30);
    ctx.beginPath();
    ctx.arc(x + 4, y, 24, 0, Math.PI * 2);
    ctx.fillStyle = "#228B22";
    ctx.fill();
  }
}

// Draw a car (simple car shape)
function drawCar(x, y, color = "#f00", scale = 1) {
  ctx.save();
  ctx.translate(x, y);
  ctx.scale(scale, scale);

  // Car body
  ctx.fillStyle = color;
  ctx.fillRect(-25, -15, 50, 30);

  // Car roof
  ctx.fillStyle = "#fff";
  ctx.fillRect(-15, -25, 30, 15);

  // Car windows
  ctx.fillStyle = "#a0d4e0";
  ctx.fillRect(-12, -23, 12, 10);
  ctx.fillRect(0, -23, 12, 10);

  // Wheels
  ctx.fillStyle = "#222";
  ctx.beginPath(); ctx.arc(-18, 17, 7, 0, Math.PI * 2); ctx.fill();
  ctx.beginPath(); ctx.arc(18, 17, 7, 0, Math.PI * 2); ctx.fill();
  ctx.beginPath(); ctx.arc(-18, -17, 7, 0, Math.PI * 2); ctx.fill();
  ctx.beginPath(); ctx.arc(18, -17, 7, 0, Math.PI * 2); ctx.fill();

  ctx.restore();
}

// Draw enemy cars (other cars)
function drawEnemyCars() {
  let positions = [
    [width * 0.48, height * 0.4, "#0ff"],
    [width * 0.52, height * 0.6, "#ff0"],
    [width * 0.47, height * 0.7, "#0f0"],
    [width * 0.53, height * 0.8, "#00f"],
  ];
  positions.forEach(([x, y, color]) => {
    drawCar(x, y, color, 0.8);
  });
}

// Game render loop
function render() {
  drawSky();
  drawBuildings();
  drawTrees();
  drawRoad();
  drawEnemyCars();
  // Player's car
  drawCar(width * 0.5, height * 0.85, "#d00", 1.1);
  requestAnimationFrame(render);
}

render();
</script>
</body>
</html>
